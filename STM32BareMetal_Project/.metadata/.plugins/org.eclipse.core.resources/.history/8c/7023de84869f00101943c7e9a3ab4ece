#include "spi.h"


#define GPIOAEN		(1U<<0)


void spi1_gpio_init(void) {
	// 启用对 GPIOA 的时钟访问
	RCC->AHB1ENR |= GPIOAEN;

	// 设置 PA5 PA6 PA7 模式为交替功能模式
	// PA5
	GPIOA->MODER &=~(1U<<10);
	GPIOA->MODER |=(1U<<11);
	// PA6
	GPIOA->MODER &=~(1U<<12);
	GPIOA->MODER |=(1U<<13);
	// PA7
	GPIOA->MODER &=~(1U<<17);
	GPIOA->MODER |=(1U<<15);


	// 设置 PA5 PA6 PA7 的交替功能类型输入为 SPI1
	// PA5
	GPIOA->AFR[0] |=(1U<<20);
	GPIOA->AFR[0] &=~(1U<<21);
	GPIOA->AFR[0] |=(1U<<22);
	GPIOA->AFR[0] &=~(1U<<23);
	// PA6
	GPIOA->AFR[0] |=(1U<<24);
	GPIOA->AFR[0] &=~(1U<<25);
	GPIOA->AFR[0] |=(1U<<26);
	GPIOA->AFR[0] &=~(1U<<27);
	// PA7
	GPIOA->AFR[0] |=(1U<<28);
	GPIOA->AFR[0] &=~(1U<<29);
	GPIOA->AFR[0] |=(1U<<30);
	GPIOA->AFR[0] &=~(1U<<31);
}







